fs=100;fp_high=40;fp_low=20;fp_low1=10;fp_low2=5;fp_low3=2;fp_low4=1;xwideth10=4.38;
wp=fp_high/(fs/2);
[b1,a1] = butter(3,wp,'high');
data=load('butter_data11.txt');
data=data(732:1170,1);
l=length(data);
t=0:1/fs:(l-1)/fs;
f=(0:l-1)*fs/l;
X=fft(data,l);
mag1=abs(X);
y=filter(b1,a1,data);
Y=fft(y,l);
mag2=abs(Y);
figure(1);
plot(t',abs(y));
figure(2);
subplot(311);
plot(t',data/75*100,'k');title('原始肌电信号');xlabel('时间(sec)');set(gca,'YTick',-100:50:100,'LineWidth',1.5);ylabel('电压(mV)');
set(gca,'XTickLabel',{'0','0.5','1.0','1.5','2.0','2.5','3.0','3.5','4.0'},'LineWidth',1.5);xlim([0 xwideth10]);
% figure(2);
% plot(f(1:l/2),mag1(1:l/2));
% figure(3);
% plot(t',y);
% figure(4);
% plot(f(1:l/2),mag2(1:l/2));
data=abs(y);
% figure(5);
% plot(t',data);
% xlim([0 8.45]);
ws=fp_low/(fs/2);
ws1=fp_low1/(fs/2);
ws2=fp_low2/(fs/2);
ws3=fp_low3/(fs/2);
ws4=fp_low4/(fs/2);
[b2,a2] = butter(3,ws,'low');
y=filter(b2,a2,data);
Y=fft(y,l);
mag=abs(Y);

% figure(7);
% plot(f(1:l/2),mag(1:l/2));
% figure(8);
% spectrogram(data,128,120,128,100,'yaxis');
[c1,d1] = butter(3,ws1,'low');
y1=filter(c1,d1,data);
Y1=fft(y1,l);
mag1=abs(Y1);
[c2,d2] = butter(3,ws2,'low');
y2=filter(c2,d2,data);
Y2=fft(y2,l);
mag2=abs(Y2);
[c3,d3] = butter(3,ws3,'low');
y3=filter(c3,d3,data);
Y3=fft(y3,l);
mag3=abs(Y3);
[c4,d4] = butter(3,ws4,'low');
y4=filter(c4,d4,data);
Y4=fft(y4,l);
mag4=abs(Y4);;

data=(data-min(data))/(max(data)-min(data));
y1=(y1-min(y1))/(max(y1)-min(y1));
subplot(312);plot(t',data,'k');xlim([0 xwideth10]);ylim([0 1.1]);title('低通滤波截止频率为20Hz');xlabel('时间(sec)');
set(gca,'XTickLabel',{'0','0.5','1.0','1.5','2.0','2.5','3.0','3.5','4.0'},'LineWidth',1.5);
set(gca,'YTickLabel',{'0','0.5','1.0'},'LineWidth',1.5);
subplot(313);plot(t',y1,'k');ylim([0 1.1]);title('低通滤波截止频率为10Hz');xlabel('时间(sec)');
set(gca,'XTickLabel',{'0','0.5','1.0','1.5','2.0','2.5','3.0','3.5','4.0'},'LineWidth',1.5);
set(gca,'YTickLabel',{'0','0.5','1.0'},'LineWidth',1.5);
%set(gca,'YTick',0:3:6);
y2=(y2-min(y2))/(max(y2)-min(y2));
y3=(y3-min(y3))/(max(y3)-min(y3));
y4=(y4-min(y4))/(max(y4)-min(y4));
xlim([0 xwideth10]);
figure(3);
subplot(311);
plot(t',y2,'k');
xlim([0 xwideth10]);title('低通滤波截止频率为5Hz');ylim([0 1.1]);xlabel('时间(sec)');set(gca,'YTickLabel',{'0','0.5','1.0'},'LineWidth',1.5);
set(gca,'XTickLabel',{'0','0.5','1.0','1.5','2.0','2.5','3.0','3.5','4.0'},'LineWidth',1.5);
subplot(312);
plot(t',y3,'k');title('低通滤波截止频率为2Hz');ylim([0 1.1]);xlabel('时间(sec)');set(gca,'YTickLabel',{'0','0.5','1.0'},'LineWidth',1.5);
xlim([0 xwideth10]);set(gca,'XTickLabel',{'0','0.5','1.0','1.5','2.0','2.5','3.0','3.5','4.0'},'LineWidth',1.5);
subplot(313);
plot(t',y4,'k');set(gca,'XTickLabel',{'0','0.5','1.0','1.5','2.0','2.5','3.0','3.5','4.0'},'LineWidth',1.5);
xlim([0 xwideth10]);title('低通滤波截止频率为1Hz');ylim([0 1.1]);xlabel('时间(sec)');set(gca,'YTick','YTickLabel',{'0','0.5','1.0'},'LineWidth',1.5);
% set(gca,'YTick',[]);