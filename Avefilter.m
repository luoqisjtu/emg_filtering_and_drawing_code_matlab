data=load('init_data10.txt');
data1=load('butterbayesian10.txt');
fs=100;
l=length(data);
filteremg=data;
jieshu=10;
emg_rect=abs(data-mean(data));
filteremg(1:jieshu,1)=emg_rect(1:jieshu,1);
for i=jieshu+1:l
  
    filteremg(i,1)=(emg_rect(i-9)+emg_rect(i-8)+emg_rect(i-7)+emg_rect(i-6)+emg_rect(i-5)+emg_rect(i-4)+emg_rect(i-3)+emg_rect(i-2)+emg_rect(i-1)+emg_rect(i))/jieshu;
                   
end
filteremg=filteremg(116:end,1);
l=length(filteremg);
data=data(116:end,1);
data1=data1(116:end,:);
figure(1);
subplot(211);
plot(0:1/fs:(l-1)/fs,data,'k');xlim([0 9.18]);title('原始肌电信号');
subplot(212);
plot(0:1/fs:(l-1)/fs,filteremg,'k');xlim([0 9.18]);title('10阶均值滤波');
figure(2);
subplot(311);plot(0:1/fs:(l-1)/fs,filteremg,'k');xlim([0 9.18]);title('10阶均值滤波');ylim([0 15]);set(gca,'YTick',[]);xlabel('Time(sec)');
subplot(312);plot(0:1/fs:(l-1)/fs,data1(:,1),'k');xlim([0 9.18]);title('线性巴特沃斯滤波');ylim([0 2.65]);set(gca,'YTick',[]);xlabel('Time(sec)');
subplot(313);plot(0:1/fs:(l-1)/fs,data1(:,2),'k');xlim([0 9.18]);title('非线性贝叶斯滤波');set(gca,'YTick',[]);xlabel('Time(sec)');
% figure(3);
% subplot(311);plot(0:1/fs:(l-1)/fs,filteremg,'k');xlim([0 4]);title('10阶均值滤波');ylim([0 15]);set(gca,'YTick',[]);xlabel('Time(sec)');
% subplot(312);plot(0:1/fs:(l-1)/fs,data1(:,1),'k');xlim([0 4]);title('线性巴特沃斯滤波');ylim([0 2.65]);set(gca,'YTick',[]);xlabel('Time(sec)');
% subplot(313);plot(0:1/fs:(l-1)/fs,data1(:,2),'k');xlim([0 4]);title('非线性贝叶斯滤波');set(gca,'YTick',[]);xlabel('Time(sec)');
figure(3);
y=filteremg(1:670);
x=(0:0.01:6.69);
x=x';
[param1]=sigm_fit(x,y);set(gca,'YTick',[]);xlabel('Time(sec)');legend('10阶均值滤波','sigmoid','Location','NorthWest');title('sigmid函数与10阶均值滤波拟合');
figure(4);
y1=data1(1:670,1);
x1=(0:0.01:6.69);
x1=x1';
[param2]=sigm_fit(x1,y1);set(gca,'YTick',[]);xlabel('Time(sec)');legend('线性巴特沃斯滤波','sigmoid','Location','NorthWest');title('sigmid函数与线性巴特沃斯滤波拟合');
figure(5);
y2=data1(1:670,2);
x2=(0:0.01:6.69);
x2=x2';
[param3]=sigm_fit(x2,y2);set(gca,'YTick',[]);xlabel('Time(sec)');legend('非线性贝叶斯滤波','sigmoid','Location','NorthWest');title('sigmid函数与非线性贝叶斯滤波拟合');
% figure(2);
% % filteremg=filteremg(1:450,1);
% [param]=sigm_fit(x,filteremg);
wending=data(350:670,1);
wending1=data1(350:670,:);
filteremg=filteremg(350:670,1);
l=length(wending);
ave1=mean(filteremg);
ave2=mean(wending1(:,1));
ave3=mean(wending1(:,2));
filteremg=filteremg/(ave1);
wending1(:,1)=wending1(:,1)/(ave2);
wending1(:,2)=wending1(:,2)/(ave3);
ave1=mean(filteremg);
ave2=mean(wending1(:,1));
ave3=mean(wending1(:,2));
v1=var(filteremg,1);
v2=var(wending1(:,1),1);
v3=var(wending1(:,2),1);
